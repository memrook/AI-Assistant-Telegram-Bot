# Телеграм-бот AI-ассистент с поиском по PDF-файлам

Данное приложение реализует функционал AI-ассистента с поиском по PDF-файлам на основе Yandex Cloud ML SDK. Ассистент работает в виде телеграм-бота и использует технологии Yandex Cloud для обработки PDF-документов со сложным форматированием и поиска информации в них.

## Особенности

- Конвертирование PDF-файлов в Markdown с помощью библиотеки docling
- Загрузка Markdown-файлов в Yandex Cloud и создание поискового индекса
- Управление сессиями пользователей в телеграм-боте (каждый пользователь общается с AI моделью внутри своего треда)
- Использование Files API для работы с файлами и треддинга для хранения контекста
- Оптимизация расходов за счет ограничения размера передаваемого контекста

## Требования

- Python 3.8 или выше
- Telegram Bot API ключ
- Yandex Cloud API ключ
- Yandex Cloud Folder ID

## Установка

1. Клонируйте репозиторий:
```
git clone <url-репозитория>
cd <название-репозитория>
```

2. Создайте и активируйте виртуальное окружение:
```
python -m venv venv
source venv/bin/activate  # для Linux/macOS
venv\Scripts\activate     # для Windows
```

3. Установите зависимости:
```
pip install -r requirements.txt
```

4. Создайте файл `.env` на основе `.env.example` и заполните его своими данными:
```
YANDEX_API_KEY=ваш-api-ключ
YANDEX_FOLDER_ID=идентификатор-каталога
TELEGRAM_BOT_TOKEN=токен-телеграм-бота
DEFAULT_TTL_DAYS=6
DEFAULT_EXPIRATION_POLICY=static
DEFAULT_TEMPERATURE=0.5
DEFAULT_MAX_PROMPT_TOKENS=50
DEFAULT_SYSTEM_PROMPT="Ваш системный промпт для модели"
```

5. Поместите PDF-файлы, которые хотите использовать для поиска, в папку `./data/docs/`.

## Запуск

Запустите приложение командой:
```
python main.py
```

## Использование

1. Найдите своего бота в Telegram по его имени.
2. Используйте команду `/start` для начала общения с ботом.
3. Задавайте вопросы боту, и он будет искать ответы в загруженных PDF-файлах.
4. Используйте команду `/reset` для сброса истории разговора.
5. Используйте команду `/help` для получения справки.

## Структура проекта

- `main.py` - основной файл для запуска приложения
- `telegram_bot.py` - модуль для телеграм-бота
- `pdf_converter.py` - модуль для конвертирования PDF в Markdown и загрузки в Yandex Cloud
- `session_manager.py` - модуль для управления сессиями и тредами пользователей
- `data/docs/` - папка для хранения PDF-файлов
- `data/md/` - папка для хранения конвертированных Markdown-файлов 